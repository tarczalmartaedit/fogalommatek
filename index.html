<!doctype html>
<html lang="hu">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Matekos √Åb√©c√© ‚Äî H√°romgy≈±r≈±s j√°t√©k</title>
  <style>
    :root{
      --bg:#f6f7fb;
      --card:#ffffff;
      --ink:#0f172a;
      --muted:#64748b;
      --line:#e5e7eb;
      --accent:#14b8a6;
      --ok:#22c55e;
      --shadow: 0 10px 30px rgba(15,23,42,.08);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Liberation Sans", sans-serif;
      color:var(--ink);
      background: linear-gradient(180deg,#fff, var(--bg));
    }
    .wrap{max-width:1200px;margin:18px auto;padding:12px;}
    .shell{
      background:#ffe9df33;
      border:1px solid #f0d8cf;
      border-radius:18px;
      padding:12px;
      box-shadow:var(--shadow);
    }
    .grid{
      display:grid;
      grid-template-columns:1.25fr .95fr;
      gap:12px;
      min-height:640px;
    }
    @media (max-width: 980px){
      .grid{grid-template-columns:1fr; min-height:auto;}
    }
    .panel{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:16px;
      padding:14px;
      box-shadow: 0 6px 20px rgba(15,23,42,.06);
      overflow:hidden;
    }
    .head{
      display:flex;align-items:center;gap:10px;
      padding:2px 2px 10px;border-bottom:1px solid var(--line);margin-bottom:10px;
    }
    .dot{width:10px;height:10px;border-radius:999px;background:var(--accent);box-shadow:0 0 0 4px rgba(20,184,166,.12);}
    .title{font-weight:700;font-size:15px;color:#0b1224;}
    .sub{color:var(--muted);font-size:12px;margin-left:auto;}

    .ringStage{
      position:relative;width:100%;
      aspect-ratio: 1/1;
      max-height:560px;margin:6px auto 0;
      background: radial-gradient(circle at 50% 45%, #ffffff 0, #ffffff 42%, #f8fafc 75%, #f8fafc 100%);
      border:1px solid #eff3f7;border-radius:14px;overflow:hidden;
    }
    .bubble{
      position:absolute;
      display:flex;align-items:center;justify-content:center;
      width:58px;height:58px;border-radius:999px;
      background:#f1f5f9;border:1px solid #e2e8f0;
      color:#0f172a;font-weight:700;
      user-select:none;
      transition: transform .18s ease, background .18s ease, border-color .18s ease, box-shadow .18s ease, opacity .18s ease;
      box-shadow:0 6px 14px rgba(2,6,23,.06);
      cursor:pointer;
    }
    .bubble.small{width:54px;height:54px;font-size:13px;}
    .bubble.tiny{width:50px;height:50px;font-size:12px;}
    .bubble:hover{transform: translateY(-2px);}

    /* √âkezetes bet≈±k: cs√≠kozott h√°tt√©r */
    .bubble.accented{
      background:
        repeating-linear-gradient(135deg, rgba(59,130,246,.10) 0, rgba(59,130,246,.10) 6px, rgba(241,245,249,1) 6px, rgba(241,245,249,1) 12px);
      border-color: rgba(59,130,246,.35);
    }
    .bubble.solved{
      background: rgba(34,197,94,.12);
      border-color: rgba(34,197,94,.45);
      box-shadow: 0 10px 22px rgba(34,197,94,.16);
      cursor:default;
    }
    .bubble.solved.accented{
      background:
        repeating-linear-gradient(135deg, rgba(34,197,94,.14) 0, rgba(34,197,94,.14) 6px, rgba(255,255,255,1) 6px, rgba(255,255,255,1) 12px);
    }
    .bubble.active{
      background: rgba(20,184,166,.12);
      border-color: rgba(20,184,166,.55);
      box-shadow: 0 10px 22px rgba(20,184,166,.18);
      transform: translateY(-2px) scale(1.03);
    }
    .bubble.active.accented{
      background:
        repeating-linear-gradient(135deg, rgba(20,184,166,.16) 0, rgba(20,184,166,.16) 6px, rgba(255,255,255,1) 6px, rgba(255,255,255,1) 12px);
    }

    .centerHint{
      position:absolute;left:50%;top:50%;
      transform: translate(-50%,-50%);
      width:200px;height:200px;border-radius:999px;
      border:2px dashed #dbeafe;
      background: rgba(59,130,246,.03);
      display:flex;align-items:center;justify-content:center;
      text-align:center;padding:14px;
      color:var(--muted);
      font-size:12px;line-height:1.25;
      pointer-events:none;
    }

    .stats{display:flex;align-items:flex-start;justify-content:space-between;gap:10px;margin-bottom:10px;}
    .statLeft{display:flex;flex-wrap:wrap;gap:12px;font-size:14px;font-weight:700;color:#0b1224;}
    .statLeft .mut{font-weight:600;color:var(--muted);}
    .timer{
      min-width:92px;text-align:center;padding:10px 12px;border-radius:999px;
      border:1px solid var(--line);background:#f8fafc;font-weight:900;font-size:22px;letter-spacing:.5px;
    }
    .clueCard{
      border:1px solid var(--line);border-radius:14px;background:#fff;padding:12px;
      box-shadow:0 6px 16px rgba(2,6,23,.06);
      margin:10px 0 12px;display:flex;gap:12px;align-items:flex-start;
      min-height:78px;
    }
    .badge{
      width:40px;height:40px;border-radius:12px;
      background: rgba(20,184,166,.12);
      border:1px solid rgba(20,184,166,.45);
      display:flex;align-items:center;justify-content:center;
      font-weight:900;
      flex: 0 0 auto;
    }
    .clueText{font-size:14px;line-height:1.35;color:#0f172a;}
    .controls{display:flex;gap:10px;align-items:center;}
    .controls input{
      flex:1;padding:12px;border-radius:12px;border:2px solid #cbd5e1;outline:none;font-size:14px;
    }
    .controls input:focus{
      border-color: rgba(20,184,166,.75);
      box-shadow: 0 0 0 4px rgba(20,184,166,.14);
    }
    button{
      padding:11px 14px;border-radius:12px;border:1px solid var(--line);
      background:#f8fafc;font-weight:800;cursor:pointer;
      transition: transform .12s ease, background .12s ease, box-shadow .12s ease;
      white-space:nowrap;
    }
    button:hover{transform: translateY(-1px); box-shadow: 0 8px 14px rgba(2,6,23,.08);}
    button.primary{background:var(--accent);border-color: rgba(20,184,166,.65);color:#fff;}
    button.primary:hover{background:#10b981;}
    .row2{margin-top:14px;display:flex;justify-content:center;}
    .hint{margin-top:14px;padding-top:12px;border-top:1px solid var(--line);color:var(--muted);font-size:12px;line-height:1.35;}
    .toast{margin-top:10px;min-height:22px;font-size:13px;font-weight:700;}
    .toast.ok{color:var(--ok);}
    .toast.bad{color:#ef4444;}
    .toast.neutral{color:var(--muted);}

    /* ‚úÖ Pont felvillan√°s k√∂z√©pen */
    #pointFlash{
      position: fixed;
      left: 50%;
      top: 50%;
      transform: translate(-50%,-50%) scale(0.6);
      background: rgba(34,197,94,0.95);
      color: white;
      font-size: 52px;
      font-weight: 900;
      padding: 26px 40px;
      border-radius: 26px;
      box-shadow: 0 20px 40px rgba(0,0,0,.25);
      opacity: 0;
      pointer-events: none;
      z-index: 9999;
      transition: all .35s ease;
      letter-spacing: .5px;
    }
    #pointFlash.show{
      opacity: 1;
      transform: translate(-50%,-50%) scale(1);
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="shell">
      <div class="grid">
        <section class="panel">
          <div class="head">
            <div class="dot"></div>
            <div class="title">Matekos √Åb√©c√© ‚Äî H√°romgy≈±r≈±s j√°t√©k (alapfogalmak)</div>
            <div class="sub">A bet≈±t a j√°t√©kos v√°lasztja ‚Ä¢ √©kezet sz√°m√≠t</div>
          </div>

          <div class="ringStage" id="ringStage" aria-label="Bet≈±k gy≈±r≈±ben">
            <div class="centerHint">
              Kattints egy bet≈±re!<br><br>
              ‚úÖ megoldva ‚Üí z√∂ld<br>
              üéØ kiv√°lasztva ‚Üí t√ºrkiz<br>
              üî∑ √©kezetes ‚Üí cs√≠kozott
            </div>
          </div>
        </section>

        <section class="panel">
          <div class="stats">
            <div class="statLeft">
              <span>Pont: <b id="score">0</b></span>
              <span class="mut">Megoldva: <b id="solvedCount">0</b>/<span id="totalCount">0</span></span>
              <span class="mut">Passz: <b id="passes">0</b></span>
              <span class="mut">H√°tra: <b id="remaining">0</b></span>
            </div>
            <div class="timer" id="timer">00:00</div>
          </div>

          <div class="clueCard">
            <div class="badge" id="badgeLetter">?</div>
            <div class="clueText" id="clueText">V√°lassz bet≈±t a bal oldali k√∂rb≈ël!</div>
          </div>

          <div class="controls">
            <input id="answer" type="text" placeholder="V√°lasz‚Ä¶" autocomplete="off" />
            <button class="primary" id="send">Bek√ºld</button>
            <button id="pass">Passz</button>
          </div>

          <div class="toast neutral" id="toast"></div>

          <div class="row2">
            <button id="reset">Reset</button>
          </div>

          <div class="hint">
            A v√°lasz kis-/nagybet≈±t≈ël f√ºggetlen, de <b>az √©kezet sz√°m√≠t</b> (A ‚â† √Å, O ‚â† √ì ‚â† √ñ).
            K√©tjegy≈± bet≈±k: <b>Sz</b>, <b>Cs</b>, <b>Gy</b>, <b>Ny</b>, <b>Zs</b>.
          </div>
        </section>
      </div>
    </div>
  </div>

  <!-- ‚úÖ pont-felvillan√°s -->
  <div id="pointFlash">+10 PONT</div>

<script>
(() => {
  // ≈ê √©s Ty kiv√©ve
  const LETTERS = ["A","√Å","B","C","Cs","D","E","√â","F","G","Gy","H","I","√ç","J","K","L","M","N","Ny","O","√ì","√ñ","P","R","S","Sz","T","U","√ö","√ú","≈∞","V","Z","Zs"];

  // Fogalmak (matekos alapfogalmak)
  const BANK = {
    "A":  [{a:"alapter√ºlet", q:"T√©rbeli test (pl. has√°b, henger) alj√°nak ter√ºlete."}],
    "√Å": [{a:"√°tl√≥", q:"A t√©glalap (vagy n√©gyzet) k√©t nem szomsz√©dos cs√∫cs√°t √∂sszek√∂t≈ë szakasz."}],
    "B":  [{a:"becsl√©s", q:"Gyors, hozz√°vet≈ëleges meghat√°roz√°s: nem pontos sz√°mol√°s, csak k√∂zel√≠t√©s."}],
    "C":  [{a:"centim√©ter", q:"Hossz√∫s√°g m√©rt√©kegys√©ge, r√∂vid√≠t√©se: cm."}],
    "Cs": [{a:"cs√∫cs", q:"Soksz√∂g ‚Äûsarka‚Äù, ahol k√©t oldal tal√°lkozik."}],
    "D":  [{a:"der√©ksz√∂g", q:"90¬∞-os sz√∂g."}],
    "E":  [{a:"egyenlet", q:"Olyan √°ll√≠t√°s, amelyben k√©t kifejez√©s egyenl≈ë (van benne ‚Äû=‚Äù jel)."}],
    "√â":  [{a:"√©rt√©k", q:"Egy kifejez√©s kisz√°molt eredm√©nye (pl. behelyettes√≠t√©s ut√°n)."}],
    "F":  [{a:"felbont√°s", q:"Egy sz√°m sz√©tszed√©se r√©szekre (pl. 345 = 300 + 40 + 5)."}],
    "G":  [{a:"grafikon", q:"Adatok √°br√°zol√°sa koordin√°ta-rendszerben (pl. oszlopdiagram, vonaldiagram)."}],
    "Gy": [{a:"gy√∂k", q:"A n√©gyzetgy√∂k jele: ‚àö. P√©lda: ‚àö9 = 3."}],
    "H":  [{a:"h√°nyados", q:"Oszt√°s eredm√©nye."}],
    "I":  [{a:"id≈ë", q:"M√©rhet≈ë mennyis√©g (m√°sodperc, perc, √≥ra)."}],
    "√ç":  [{a:"√≠r√°sbeli", q:"Olyan sz√°mol√°si m√≥d, amikor l√©p√©sr≈ël l√©p√©sre le√≠rjuk a m≈±veletet (pl. √≠r√°sbeli √∂sszead√°s)."}],
    "J":  [{a:"jel", q:"Matematikai szimb√≥lum (pl. +, ‚àí, ¬∑, :, =)."}],
    "K":  [{a:"ker√ºlet", q:"Egy s√≠kidom hat√°rol√≥ vonal√°nak teljes hossza."}],
    "L":  [{a:"l√©pt√©k", q:"Ar√°ny, ami megmutatja, hogy a t√©rk√©p/rajz mennyire kicsiny√≠t vagy nagy√≠t."}],
    "M":  [{a:"m√©rt√©kegys√©g", q:"A m√©r√©s ‚Äûegys√©ge‚Äù (pl. cm, m, kg, l)."}],
    "N":  [{a:"n√©gyzet", q:"Olyan t√©glalap, amelynek minden oldala egyenl≈ë."}],
    "Ny": [{a:"nyolc", q:"A 8-as sz√°m neve."}],
    "O":  [{a:"oszt√≥", q:"Az a sz√°m, amellyel osztunk (pl. 12 : 3 eset√©n 3)."}],
    "√ì":  [{a:"√≥ra", q:"Id≈ëm√©rt√©kegys√©g: 60 perc."}],
    "√ñ":  [{a:"√∂sszeg", q:"√ñsszead√°s eredm√©nye."}],
    "P":  [{a:"p√°ratlan", q:"Olyan eg√©sz sz√°m, ami nem oszthat√≥ 2-vel marad√©k n√©lk√ºl."}],
    "R":  [{a:"r√©sz", q:"Egy eg√©sznek a darabja (pl. a torta egy r√©sze)."}],
    "S":  [{a:"sug√°r", q:"A k√∂r k√∂z√©ppontj√°t a k√∂rvonal egy pontj√°val √∂sszek√∂t≈ë szakasz."}],
    "Sz": [{a:"sz√°ml√°l√≥", q:"T√∂rtben a fels≈ë sz√°m (pl. 3/5-ben a 3)."}],
    "T":  [{a:"t√∂rtsz√°m", q:"Olyan sz√°m, ami egy eg√©sz r√©sz√©t jelenti (pl. 1/2, 3/4)."}],
    "U":  [{a:"univerz√°lis", q:"Olyan, ami sok helyzetben haszn√°lhat√≥ (pl. univerz√°lis m√≥dszer)."}],
    "√ö":  [{a:"√∫thossz", q:"A megtett √∫t hossza (pl. km-ben m√©rj√ºk)."}],
    "√ú":  [{a:"√ºtem", q:"Ritmus/l√©p√©ssz√°m: pl. ‚Äûminden l√©p√©sben 2-vel n≈ë‚Äù (sorozatokn√°l)."}],
    "≈∞":  [{a:"≈±rtartalom", q:"A tart√°lyban elf√©r≈ë mennyis√©g (pl. literben)."}],
    "V":  [{a:"val√≥sz√≠n≈±s√©g", q:"Annak ‚Äûes√©lye‚Äù, hogy valami megt√∂rt√©nik (0 √©s 1 k√∂z√∂tt)."}],
    "Z":  [{a:"z√°r√≥jel", q:"Jel, ami megmutatja a m≈±veleti sorrendet: ( )."}],
    "Zs": [{a:"zsugor√≠t√°s", q:"M√©retek ar√°nyos cs√∂kkent√©se (kicsiny√≠t√©s)."}]
  };

  // Csak azok a bet≈±k sz√°m√≠tanak megoldand√≥nak, amelyekhez van feladv√°ny
  const PLAYABLE = LETTERS.filter(l => (BANK[l] && BANK[l].length));

  // √Ållapot
  let solved = new Set();   // PLAYABLE-b≈ël
  let currentLetter = null;
  let currentQA = null;
  let score = 0;
  let passes = 0;

  let t0 = null;
  let timerId = null;

  // DOM
  const stage = document.getElementById("ringStage");
  const badgeLetter = document.getElementById("badgeLetter");
  const clueText = document.getElementById("clueText");
  const answerEl = document.getElementById("answer");
  const toastEl = document.getElementById("toast");

  const scoreEl = document.getElementById("score");
  const solvedEl = document.getElementById("solvedCount");
  const totalEl = document.getElementById("totalCount");
  const passesEl = document.getElementById("passes");
  const remainingEl = document.getElementById("remaining");
  const timerEl = document.getElementById("timer");

  const pointFlash = document.getElementById("pointFlash");

  totalEl.textContent = PLAYABLE.length;

  // Seg√©dek
  const lower = (s) => (s ?? "").toString().trim().toLocaleLowerCase("hu-HU");
  const ACCENTED_SINGLE = new Set(["√Å","√â","√ç","√ì","√ñ","√ö","√ú","≈∞"]);
  function isAccentedLetter(letter){
    if(letter.length === 1) return ACCENTED_SINGLE.has(letter);
    return /[√Å√â√ç√ì√ñ≈ê√ö√ú≈∞√°√©√≠√≥√∂≈ë√∫√º≈±]/.test(letter);
  }
  function startsWithLetter(word, letter){
    return lower(word).startsWith(lower(letter));
  }
  function fmtTime(ms){
    const s = Math.floor(ms/1000);
    const mm = String(Math.floor(s/60)).padStart(2,"0");
    const ss = String(s%60).padStart(2,"0");
    return `${mm}:${ss}`;
  }
  function setToast(kind, msg){
    toastEl.className = "toast " + (kind || "neutral");
    toastEl.textContent = msg || "";
  }
  function updateStats(){
    scoreEl.textContent = score;
    solvedEl.textContent = solved.size;
    passesEl.textContent = passes;
    remainingEl.textContent = Math.max(0, PLAYABLE.length - solved.size);
  }
  function pickQA(letter){
    const arr = BANK[letter] || [];
    return arr[Math.floor(Math.random()*arr.length)];
  }
  function showPoint(points){
    pointFlash.textContent = `+${points} PONT`;
    pointFlash.classList.add("show");
    setTimeout(() => pointFlash.classList.remove("show"), 900);
  }

  function setCurrent(letter){
    currentLetter = letter;
    currentQA = pickQA(letter);
    badgeLetter.textContent = letter;
    clueText.textContent = currentQA.q;
    answerEl.value = "";
    answerEl.focus();
    renderRings();
    setToast("neutral", "");
  }

  function clearCurrent(){
    currentLetter = null;
    currentQA = null;
    badgeLetter.textContent = "?";
    clueText.textContent = "V√°lassz bet≈±t a bal oldali k√∂rb≈ël!";
    answerEl.value = "";
    renderRings();
  }

  function finishIfDone(){
    if(solved.size === PLAYABLE.length){
      setToast("ok", `K√©sz! üéâ Teljes√≠tetted az √∂sszes feladv√°nyos bet≈±t. Pont: ${score}`);
      badgeLetter.textContent = "‚úì";
      clueText.textContent = "Gratul√°lok! Nyomj Resetet egy √∫j k√∂rh√∂z.";
      currentLetter = null;
      currentQA = null;
      renderRings();
      return true;
    }
    return false;
  }

  // Gy≈±r≈± kirajzol√°s
  function renderRings(){
    stage.querySelectorAll(".bubble").forEach(n => n.remove());

    const rect = stage.getBoundingClientRect();
    const cx = rect.width/2;
    const cy = rect.height/2;

    const rings = [
      {r: Math.min(rect.width,rect.height)*0.22, count: 12},
      {r: Math.min(rect.width,rect.height)*0.33, count: 12},
      {r: Math.min(rect.width,rect.height)*0.44, count: LETTERS.length - 24}
    ];

    const ringLetters = [];
    let idx = 0;
    for(const rg of rings){
      ringLetters.push(LETTERS.slice(idx, idx+rg.count));
      idx += rg.count;
    }

    ringLetters.forEach((arr, ringIndex) => {
      const rg = rings[ringIndex];
      const count = arr.length || 1;
      arr.forEach((letter, i) => {
        const angle = (-90 + (360 * i / count)) * Math.PI/180;
        const x = cx + rg.r * Math.cos(angle);
        const y = cy + rg.r * Math.sin(angle);

        const b = document.createElement("div");
        b.className = "bubble";
        if(letter.length >= 2) b.classList.add("small");
        if(letter.length >= 3) b.classList.add("tiny");
        if(isAccentedLetter(letter)) b.classList.add("accented");

        const hasQA = !!(BANK[letter] && BANK[letter].length);

        if(hasQA && solved.has(letter)) b.classList.add("solved");
        if(letter === currentLetter) b.classList.add("active");

        b.textContent = letter;
        b.style.left = (x - 29) + "px";
        b.style.top  = (y - 29) + "px";

        b.addEventListener("click", () => {
          if(!hasQA){
            setToast("neutral", `Ehhez a bet≈±h√∂z most nincs feladv√°ny: ${letter}`);
            return;
          }
          if(solved.has(letter)){
            setToast("neutral", "Ez a bet≈± m√°r k√©sz ‚úÖ V√°lassz m√°sikat!");
            return;
          }
          setCurrent(letter);
        });

        stage.appendChild(b);
      });
    });
  }

  // Id≈ëm√©r≈ë
  function startTimer(){
    if(timerId) clearInterval(timerId);
    t0 = performance.now();
    timerId = setInterval(() => {
      timerEl.textContent = fmtTime(performance.now() - t0);
    }, 250);
  }

  // Bek√ºld√©s
  function submit(){
    if(!currentLetter){
      setToast("neutral", "El≈ësz√∂r v√°lassz egy bet≈±t a k√∂rb≈ël!");
      return;
    }

    const ans = lower(answerEl.value);
    if(!ans){
      setToast("neutral", "√çrj be egy v√°laszt!");
      return;
    }

    const correct = currentQA?.a ?? "";
    const okExact = lower(correct) === ans;
    const okStart = startsWithLetter(ans, currentLetter);

    if(okExact && okStart){
      solved.add(currentLetter);
      score += 10;
      showPoint(10);
      setToast("ok", `Helyes! ‚úÖ (${correct})`);
      updateStats();
      renderRings();

      if(finishIfDone()) return;

      // ‚úÖ nem ad automatikusan √∫j bet≈±t
      clearCurrent();
      return;
    }

    if(okStart && !okExact){
      setToast("bad", `J√≥ a kezd≈ëbet≈± (${currentLetter}), de most a keresett fogalom nem ez. Pr√≥b√°ld √∫jra!`);
      return;
    }

    setToast("bad", `Nem j√≥. Tipp: a v√°lasz ${currentLetter}-vel kezd≈ëdik (√©kezet sz√°m√≠t!).`);
  }

  // Passz: elengedi az aktu√°lis bet≈±t, de nem oldja meg
  function doPass(){
    if(!currentLetter){
      setToast("neutral", "Nincs kiv√°lasztott bet≈±. Kattints egy bet≈±re!");
      return;
    }
    passes += 1;
    score = Math.max(0, score - 2);
    updateStats();
    setToast("neutral", "Passz. (-2 pont) V√°lassz egy m√°sik bet≈±t!");
    clearCurrent();
  }

  // Reset
  function reset(){
    solved = new Set();
    currentLetter = null;
    currentQA = null;
    score = 0;
    passes = 0;
    timerEl.textContent = "00:00";
    setToast("neutral", "");
    updateStats();
    renderRings();
    startTimer();
    clearCurrent();
  }

  // Esem√©nyek
  document.getElementById("send").addEventListener("click", submit);
  document.getElementById("pass").addEventListener("click", doPass);
  document.getElementById("reset").addEventListener("click", reset);

  answerEl.addEventListener("keydown", (e) => {
    if(e.key === "Enter") submit();
    if(e.key === "Escape") doPass();
  });

  let resizeTimer = null;
  window.addEventListener("resize", () => {
    clearTimeout(resizeTimer);
    resizeTimer = setTimeout(renderRings, 120);
  });

  // Init
  updateStats();
  renderRings();
  startTimer();
  clearCurrent();
})();
</script>
</body>
</html>
